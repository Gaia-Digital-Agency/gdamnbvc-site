import{g as u,d as v,e as f}from"./app-CGPgJ7qc.js";import{S}from"./swiper-core-BWsPD-mm.js";import{C as b}from"./choices-PN3yYAsG.js";const I=n=>{const t=document.querySelector("#donation-form"),a=document.querySelector("#donation-overlay"),l=t.querySelector(".outer-wrapper"),o=`
    a[href],
    button,
    input,
    textarea,
    select,
    [tabindex]:not([tabindex="-1"])
    `,r=t.querySelector(".swiper"),i=new S(r,{slidesPerView:1,allowTouchMove:!1});u.set(t,{visibility:"hidden"}),u.set(l,{xPercent:-100}),u.set(a,{autoAlpha:0});const e=()=>{v(),u.to(t,{visibility:"visible"}),u.to(l,{xPercent:0}),u.to(a,{autoAlpha:1}),t.hidden=!1,t.querySelectorAll(o)[0]?.focus()},c=()=>{f(),u.to(t,{visibility:"hidden"}),u.to(l,{xPercent:-100}),u.to(a,{autoAlpha:0}),t.hidden=!0};document.querySelectorAll(".trigger-donation-form").forEach(s=>{s.addEventListener("click",()=>{e()})}),a.addEventListener("click",()=>{c()}),t.querySelector(".close-icon").addEventListener("click",()=>{c()}),window.addEventListener("keydown",s=>{s.key==="Escape"&&!t.hidden&&c()}),t.addEventListener("keydown",s=>{if(s.key!=="Tab")return;const y=t.querySelectorAll(o),m=y[0],p=y[y.length-1];s.shiftKey&&document.activeElement===m&&(s.preventDefault(),p.focus()),!s.shiftKey&&document.activeElement===p&&(s.preventDefault(),m.focus())}),h(t,i),E(t),q(t),L(t),A(t)},h=(n,t)=>{const a=(e,c,d=()=>{},s=()=>{})=>({name:e,validation:c,errorHandler:d,resetError:s}),l=[[a("amount",e=>parseInt(e)!=NaN&&e>=1e4,e=>{e.querySelector("#error-amount").style.display="block"},e=>{e.querySelector("#error-amount").style.display="none"}),a("period",e=>e=="once"||e=="monthly"||e=="yearly")],[a("type",e=>e=="individual"||e=="organization"),a("first-name",e=>!!e,e=>{e.querySelector("#error-first-name").style.display="block"},e=>{e.querySelector("#error-first-name").style.display="none"}),a("last-name",e=>!!e,e=>{e.querySelector("#error-last-name").style.display="block"},e=>{e.querySelector("#error-last-name").style.display="none"}),a("email",e=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e),e=>{e.querySelector("#error-email").style.display="block"},e=>{e.querySelector("#error-email").style.display="none"}),a("mobile-number",e=>!!e,e=>{e.querySelector("#error-mobile-number").style.display="block"},e=>{e.querySelector("#error-mobile-number").style.display="none"})]],o=e=>{let c=0;return t.slides[e].querySelectorAll(".mandatory").forEach(d=>{l[e].filter(s=>{d.name==s.name&&(s.validation(d.value)?(c=c+1,s.resetError(n)):s.errorHandler(n))})}),c>=l[e].length},r=n.querySelector(".prev-button");r.addEventListener("click",()=>{t.slides[t.activeIndex-1]&&(t.slidePrev(),t.slides[t.activeIndex-1]&&(r.style.opacity="0",r.style.pointerEvents="none"))}),n.querySelector(".next-button").addEventListener("click",async()=>{if(o(t.activeIndex))if(t.slides[t.activeIndex+2])t.slides[t.activeIndex+1].querySelectorAll("input, select").forEach(e=>{e.nodeName=="SELECT"&&e.choices.enable(),e.disabled=!1}),t.slideNext(),r.style.opacity="1",r.style.pointerEvents="all";else{const e=await n.querySelector("form").submitter();if(console.log(e),e&&e.payment_link_url){const c=document.createElement("iframe"),d=e.payment_link_url;c.src=d,n.querySelector("#iframe-wrapper").append(c),t.slideNext()}}})},E=n=>{const t=n.querySelectorAll(".amount-wrapper .amount-select"),a=()=>{t.forEach(i=>{i.classList.remove("active")})},l=n.querySelector("#input-amount"),o=n.querySelector("#manual-input"),r=i=>{console.log(i.classList.contains("disabled")),!i.classList.contains("disabled")&&(a(),i.classList.add("active"),l.value=i.dataset.amount,o.value=i.dataset.amount)};t.forEach(i=>{i.addEventListener("click",()=>{r(i)}),i.addEventListener("focus",()=>{r(i)})}),o.addEventListener("change",()=>{a(),l.value=o.value,o.value=o.value.toLocaleString("id-ID")})},q=n=>{const t=()=>{o.forEach(r=>{r.classList.remove("active")})},a=r=>{r.classList.contains("disabled")||(t(),r.classList.add("active"),l.value=r.dataset.period)},l=n.querySelector("#input-period"),o=n.querySelectorAll(".period-select");o.forEach(r=>{r.addEventListener("click",()=>{a(r)}),r.addEventListener("focus",()=>{a(r)})})},L=n=>{const t=[{value:"mr",label:"Mr"},{value:"mrs",label:"Mrs"},{value:"miss",label:"Miss"},{value:"ms",label:"Ms"}],a=n.querySelector("#input-title");a.choices=new b(a,{choices:t,searchEnabled:!1,itemSelectText:""})},A=n=>{const t=n.querySelectorAll(".type-select"),a=()=>{t.forEach(o=>{o.classList.remove("active")})},l=n.querySelector(".organization-wrapper");u.set(l,{autoAlpha:0}),t.forEach(o=>{o.addEventListener("click",()=>{a(),o.classList.add("active");const r=o.dataset.type;r=="organization"&&u.set(l,{autoAlpha:1}),r=="individual"&&u.set(l,{autoAlpha:0})})})};export{I as initDonationForm};
