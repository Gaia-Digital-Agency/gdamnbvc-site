import{g as c,d as m,e as f}from"./app-4kXaaxs_.js";import{S}from"./swiper-core-BWsPD-mm.js";import{C as b}from"./choices-PN3yYAsG.js";const I=o=>{const t=document.querySelector("#donation-form"),a=document.querySelector("#donation-overlay"),s=t.querySelector(".outer-wrapper"),n=`
    a[href],
    button,
    input,
    textarea,
    select,
    [tabindex]:not([tabindex="-1"])
    `,r=t.querySelector(".swiper"),d=new S(r,{slidesPerView:1,allowTouchMove:!1,autoHeight:!0});c.set(t,{visibility:"hidden"}),c.set(s,{xPercent:-100}),c.set(a,{autoAlpha:0});const e=()=>{m(),c.to(t,{visibility:"visible"}),c.to(s,{xPercent:0}),c.to(a,{autoAlpha:1}),t.hidden=!1,t.querySelectorAll(n)[0]?.focus()},i=()=>{f(),c.to(t,{visibility:"hidden"}),c.to(s,{xPercent:-100}),c.to(a,{autoAlpha:0}),t.hidden=!0};document.querySelectorAll(".trigger-donation-form").forEach(l=>{l.addEventListener("click",()=>{e()})}),a.addEventListener("click",()=>{i()}),t.querySelector(".close-icon").addEventListener("click",()=>{i()}),window.addEventListener("keydown",l=>{l.key==="Escape"&&!t.hidden&&i()}),t.addEventListener("keydown",l=>{if(l.key!=="Tab")return;const y=t.querySelectorAll(n),p=y[0],v=y[y.length-1];l.shiftKey&&document.activeElement===p&&(l.preventDefault(),v.focus()),!l.shiftKey&&document.activeElement===v&&(l.preventDefault(),p.focus())}),h(t,d),E(t),q(t),L(t),g(t)},h=(o,t)=>{const a=(e,i,u=()=>{},l=()=>{})=>({name:e,validation:i,errorHandler:u,resetError:l}),s=[[a("amount",e=>parseInt(e)!=NaN&&e>=1e4,e=>{e.querySelector("#error-amount").style.display="block"},e=>{e.querySelector("#error-amount").style.display="none"}),a("period",e=>e=="once"||e=="monthly"||e=="yearly")],[a("type",e=>e=="individual"||e=="organization"),a("first-name",e=>!!e,e=>{e.querySelector("#error-first-name").style.display="block"},e=>{e.querySelector("#error-first-name").style.display="none"}),a("last-name",e=>!!e,e=>{e.querySelector("#error-last-name").style.display="block"},e=>{e.querySelector("#error-last-name").style.display="none"}),a("email",e=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e),e=>{e.querySelector("#error-email").style.display="block"},e=>{e.querySelector("#error-email").style.display="none"}),a("mobile-number",e=>!!e,e=>{e.querySelector("#error-mobile-number").style.display="block"},e=>{e.querySelector("#error-mobile-number").style.display="none"})]],n=e=>{let i=0;return t.slides[e].querySelectorAll(".mandatory").forEach(u=>{s[e].filter(l=>{u.name==l.name&&(l.validation(u.value)?(i=i+1,l.resetError(o)):l.errorHandler(o))})}),i>=s[e].length},r=o.querySelector(".prev-button");r.addEventListener("click",()=>{t.slides[t.activeIndex-1]&&(t.slidePrev(),t.slides[t.activeIndex-1]&&(r.style.opacity="0",r.style.pointerEvents="none"))}),o.querySelector(".next-button").addEventListener("click",async()=>{if(n(t.activeIndex))if(t.slides[t.activeIndex+2])t.slides[t.activeIndex+1].querySelectorAll("input, select").forEach(e=>{e.nodeName=="SELECT"&&e.choices.enable(),e.disabled=!1}),t.slideNext(),r.style.opacity="1",r.style.pointerEvents="all";else{const e=await o.querySelector("form").submitter();if(console.log(e),e&&e.payment_link_url){const i=document.createElement("iframe"),u=e.payment_link_url;i.src=u,o.querySelector("#iframe-wrapper").append(i),t.slideNext()}}})},E=o=>{const t=o.querySelectorAll(".amount-wrapper .amount-select"),a=()=>{t.forEach(e=>{e.classList.remove("active")})},s=o.querySelector("#input-amount"),n=o.querySelector("#manual-input"),r=()=>{const e=n.value.replace(/\D/g,"");if(!e){n.value="";return}n.value=e.replace(/\B(?=(\d{3})+(?!\d))/g,".")};n.addEventListener("input",r);const d=e=>{console.log(e.classList.contains("disabled")),!e.classList.contains("disabled")&&(a(),e.classList.add("active"),s.value=e.dataset.amount,n.value=e.dataset.amount,r())};t.forEach(e=>{e.addEventListener("click",()=>{d(e)}),e.addEventListener("focus",()=>{d(e)})}),n.addEventListener("change",()=>{a(),s.value=n.value.replace(/\./g,""),n.value=n.value.toLocaleString("id-ID")})},q=o=>{const t=()=>{n.forEach(r=>{r.classList.remove("active")})},a=r=>{r.classList.contains("disabled")||(t(),r.classList.add("active"),s.value=r.dataset.period)},s=o.querySelector("#input-period"),n=o.querySelectorAll(".period-select");n.forEach(r=>{r.addEventListener("click",()=>{a(r)}),r.addEventListener("focus",()=>{a(r)})})},L=o=>{const t=[{value:"mr",label:"Mr"},{value:"mrs",label:"Mrs"},{value:"miss",label:"Miss"},{value:"ms",label:"Ms"}],a=o.querySelector("#input-title");a.choices=new b(a,{choices:t,searchEnabled:!1,itemSelectText:""})},g=o=>{const t=o.querySelectorAll(".type-select"),a=()=>{t.forEach(n=>{n.classList.remove("active")})},s=o.querySelector(".organization-wrapper");c.set(s,{autoAlpha:0}),t.forEach(n=>{n.addEventListener("click",()=>{a(),n.classList.add("active");const r=n.dataset.type;r=="organization"&&c.set(s,{autoAlpha:1}),r=="individual"&&c.set(s,{autoAlpha:0})})})};export{I as initDonationForm};
