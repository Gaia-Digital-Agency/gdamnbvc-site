import{g as c,d as m,e as f}from"./app-COdneMVz.js";import{S}from"./swiper-core-BkdoSGCI.js";import{C as b}from"./choices-PN3yYAsG.js";const w=n=>{const t=document.querySelector("#donation-form"),o=document.querySelector("#donation-overlay"),i=t.querySelector(".outer-wrapper"),a=`
    a[href],
    button,
    input,
    textarea,
    select,
    [tabindex]:not([tabindex="-1"])
    `,r=t.querySelector(".swiper"),l=new S(r,{slidesPerView:1,allowTouchMove:!1});c.set(t,{visibility:"hidden"}),c.set(i,{xPercent:-100}),c.set(o,{autoAlpha:0});const e=()=>{m(),c.to(t,{visibility:"visible"}),c.to(i,{xPercent:0}),c.to(o,{autoAlpha:1}),t.hidden=!1,t.querySelectorAll(a)[0]?.focus()},u=()=>{f(),c.to(t,{visibility:"hidden"}),c.to(i,{xPercent:-100}),c.to(o,{autoAlpha:0}),t.hidden=!0};document.querySelectorAll(".trigger-donation-form").forEach(s=>{s.addEventListener("click",()=>{e()})}),o.addEventListener("click",()=>{u()}),window.addEventListener("keydown",s=>{s.key==="Escape"&&!t.hidden&&u()}),console.log(l.slides),t.addEventListener("keydown",s=>{if(s.key!=="Tab")return;const y=t.querySelectorAll(a),p=y[0],v=y[y.length-1];s.shiftKey&&document.activeElement===p&&(s.preventDefault(),v.focus()),!s.shiftKey&&document.activeElement===v&&(s.preventDefault(),p.focus())}),h(t,l),E(t),q(t),L(t),A(t)},h=(n,t)=>{const o=(e,u,d=()=>{},s=()=>{})=>({name:e,validation:u,errorHandler:d,resetError:s}),i=[[o("amount",e=>parseInt(e)!=NaN&&e>=1e4,e=>{e.querySelector("#error-amount").style.display="block"},e=>{e.querySelector("#error-amount").style.display="none"}),o("period",e=>e=="once"||e=="monthly"||e=="yearly")],[o("type",e=>e=="individual"||e=="organization"),o("first-name",e=>!!e,e=>{e.querySelector("#error-first-name").style.display="block"},e=>{e.querySelector("#error-first-name").style.display="none"}),o("last-name",e=>!!e,e=>{e.querySelector("#error-last-name").style.display="block"},e=>{e.querySelector("#error-last-name").style.display="none"}),o("email",e=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e),e=>{e.querySelector("#error-email").style.display="block"},e=>{e.querySelector("#error-email").style.display="none"}),o("mobile-number",e=>!!e,e=>{e.querySelector("#error-mobile-number").style.display="block"},e=>{e.querySelector("#error-mobile-number").style.display="none"})]],a=e=>{let u=0;return t.slides[e].querySelectorAll(".mandatory").forEach(d=>{i[e].filter(s=>{d.name==s.name&&(console.log(s,"validating"),s.validation(d.value)?(u=u+1,s.resetError(n)):s.errorHandler(n))})}),u>=i[e].length},r=n.querySelector(".prev-button");r.addEventListener("click",()=>{t.slidePrev(),r.style.opacity="0",r.style.pointerEvents="none"}),n.querySelector(".next-button").addEventListener("click",()=>{a(t.activeIndex)&&(t.slides[t.activeIndex+1]?(t.slides[t.activeIndex+1].querySelectorAll("input, select").forEach(e=>{e.nodeName=="SELECT"&&e.choices.enable(),e.disabled=!1}),t.slideNext(),r.style.opacity="1",r.style.pointerEvents="all"):n.querySelector("form").submitter())})},E=n=>{const t=n.querySelectorAll(".amount-wrapper .amount-select"),o=()=>{t.forEach(l=>{l.classList.remove("active")})},i=n.querySelector("#input-amount"),a=n.querySelector("#manual-input"),r=l=>{console.log(l.classList.contains("disabled")),!l.classList.contains("disabled")&&(o(),l.classList.add("active"),i.value=l.dataset.amount,a.value=l.dataset.amount)};t.forEach(l=>{l.addEventListener("click",()=>{r(l)}),l.addEventListener("focus",()=>{r(l)})}),a.addEventListener("change",()=>{o(),i.value=a.value,a.value=a.value.toLocaleString("id-ID")})},q=n=>{const t=()=>{a.forEach(r=>{r.classList.remove("active")})},o=r=>{r.classList.contains("disabled")||(t(),r.classList.add("active"),i.value=r.dataset.period)},i=n.querySelector("#input-period"),a=n.querySelectorAll(".period-select");a.forEach(r=>{r.addEventListener("click",()=>{o(r)}),r.addEventListener("focus",()=>{o(r)})})},L=n=>{const t=[{value:"mr",label:"Mr"},{value:"mrs",label:"Mrs"},{value:"miss",label:"Miss"},{value:"ms",label:"Ms"}],o=n.querySelector("#input-title");o.choices=new b(o,{choices:t,searchEnabled:!1,itemSelectText:""})},A=n=>{const t=n.querySelectorAll(".type-select"),o=()=>{t.forEach(a=>{a.classList.remove("active")})},i=n.querySelector(".organization-wrapper");c.set(i,{autoAlpha:0}),t.forEach(a=>{a.addEventListener("click",()=>{o(),a.classList.add("active");const r=a.dataset.type;r=="organization"&&c.set(i,{autoAlpha:1}),r=="individual"&&c.set(i,{autoAlpha:0})})})};export{w as initDonationForm};
